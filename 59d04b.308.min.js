(window.webpackJsonp=window.webpackJsonp||[]).push([[308],{1145:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),c=t(1169);a.default=function(e){const[a,t]=Object(n.useState)(!1),[s,m]=Object(n.useState)(!1);localStorage.getItem("arco-lang");return l.a.createElement("span",{style:e.style,className:"markdown-body"},l.a.createElement(c.a,null,l.a.createElement("title",null,"打包构建 | SensoroDesign"),l.a.createElement("meta",{name:"description",content:"了解物料项目的开发与构建。"}),l.a.createElement("meta",{property:"og:title",content:"打包构建 | SensoroDesign"}),l.a.createElement("meta",{property:"og:description",content:"了解物料项目的开发与构建。"})),l.a.createElement("div",{className:"ac-nav-intro"},l.a.createElement("p",null,"物料平台"),l.a.createElement("h1",{id:"打包构建"},"打包构建"),l.a.createElement("p",null,"了解物料项目的开发与构建。")),l.a.createElement("p",null,l.a.createElement("em",null,"本文基于 Arco 官方物料模板所创建的项目进行说明")),l.a.createElement("h2",{id:"组件构建"},"组件构建"),l.a.createElement("p",null,"arco-scripts 的构建命令内置了组件 JS、图标、样式的构建功能。通常情况下，你只需要通过以下命令来构建所有："),l.a.createElement("pre",null,l.a.createElement("code",null,"arco",l.a.createElement("span",{className:"token operator"},"-"),"scripts build",l.a.createElement("span",{className:"token punctuation"},":"),"component")),l.a.createElement("p",null,"通过 ",l.a.createElement("code",null,"build:component")," 将会构建出 ES/CommonJS/UMD 版本的 JS 文件，打包样式文件，如果项目中存在图标文件夹，还会进行图标构建。",l.a.createElement("code",null,"build:component")," 是下面所有命令的总和，大多数时候你不需要使用到下面的子命令，但理解这些命令将有助于你理解整个项目结构:"),l.a.createElement("pre",{className:"code_block"},l.a.createElement("code",{className:"language-bash"},l.a.createElement("span",{className:"token comment"},"# 构建对应的 ES 模块 - tsc"),l.a.createElement("br",null),"arco-scripts build:component:es",l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("span",{className:"token comment"},"# 构建 CommonJS 模块 - tsc"),l.a.createElement("br",null),"arco-scripts build:component:cjs",l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("span",{className:"token comment"},"# 构建 UMD 输出 - Webpack"),l.a.createElement("br",null),"arco-scripts build:component:dist",l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("span",{className:"token comment"},"# 样式构建 - gulp-less"),l.a.createElement("br",null),"arco-scripts build:component:css",l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("span",{className:"token comment"},"# 图标构建（如有）- Webpack"),l.a.createElement("br",null),"arco-scripts build:icon")),l.a.createElement("h2",{id:"书写-demo"},l.a.createElement("strong",null,"书写 Demo")),l.a.createElement("p",null,"为了方便测试组件功能和他人快速入门，需要为你的组件提供至少一个 Demo，你应当在 ",l.a.createElement("code",null,"/src/demo/")," 目录下书写这些 Demo。一个标准的 Demo 文件内容如下："),l.a.createElement("pre",{className:"code_block"},l.a.createElement("code",{className:"language-jsx"},l.a.createElement("span",{className:"token comment"},"// /src/demo/basic.jsx"),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword module"},"import")," ",l.a.createElement("span",{className:"token imports"},l.a.createElement("span",{className:"token maybe-class-name"},"React"))," ",l.a.createElement("span",{className:"token keyword module"},"from")," ",l.a.createElement("span",{className:"token string"},"'react'"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword module"},"import")," ",l.a.createElement("span",{className:"token imports"},l.a.createElement("span",{className:"token maybe-class-name"},"TooltipButton"))," ",l.a.createElement("span",{className:"token keyword module"},"from")," ",l.a.createElement("span",{className:"token string"},"'@arco-design/rc-hello-arco'"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword module"},"export")," ",l.a.createElement("span",{className:"token keyword module"},"default")," ",l.a.createElement("span",{className:"token punctuation"},"("),l.a.createElement("span",{className:"token punctuation"},")")," ",l.a.createElement("span",{className:"token arrow operator"},"=>")," ",l.a.createElement("span",{className:"token punctuation"},"{"),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token keyword control-flow"},"return")," ",l.a.createElement("span",{className:"token tag"},l.a.createElement("span",{className:"token tag"},l.a.createElement("span",{className:"token punctuation"},"<"),l.a.createElement("span",{className:"token class-name"},"TooltipButton"))," ",l.a.createElement("span",{className:"token attr-name"},"title"),l.a.createElement("span",{className:"token attr-value"},l.a.createElement("span",{className:"token punctuation attr-equals"},"="),l.a.createElement("span",{className:"token punctuation"},'"'),"tooltip title",l.a.createElement("span",{className:"token punctuation"},'"')),l.a.createElement("span",{className:"token punctuation"},">")),l.a.createElement("span",{className:"token maybe-class-name"},"Demo")," ",l.a.createElement("span",{className:"token maybe-class-name"},"Basic"),l.a.createElement("span",{className:"token tag"},l.a.createElement("span",{className:"token tag"},l.a.createElement("span",{className:"token punctuation"},"</"),l.a.createElement("span",{className:"token class-name"},"TooltipButton")),l.a.createElement("span",{className:"token punctuation"},">")),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("span",{className:"token punctuation"},"}"),l.a.createElement("span",{className:"token punctuation"},";"))),l.a.createElement("p",null,"在 Demo 入口文件中，添加物料描述和 Demo 描述，这些信息将在物料平台被提取和展示。"),l.a.createElement("pre",{className:"code_block"},l.a.createElement("code",{className:"language-javascript"},l.a.createElement("span",{className:"token comment"},"// /src/demo/index.js"),l.a.createElement("br",null),l.a.createElement("span",{className:"token comment"},"/**",l.a.createElement("br",null)," * @file",l.a.createElement("br",null)," * @name 组将名，例如：EmployeeSelect",l.a.createElement("br",null)," * @memberOf 组件类型，例如：数据输入",l.a.createElement("br",null)," * @description 描述你的组件",l.a.createElement("br",null)," */"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("span",{className:"token comment"},"/**",l.a.createElement("br",null)," * @name 基本用法",l.a.createElement("br",null)," * @description 描述你的例子",l.a.createElement("br",null)," */"),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword module"},"export")," ",l.a.createElement("span",{className:"token exports"},l.a.createElement("span",{className:"token punctuation"},"{")," ",l.a.createElement("span",{className:"token keyword module"},"default")," ",l.a.createElement("span",{className:"token keyword module"},"as")," ",l.a.createElement("span",{className:"token maybe-class-name"},"Basic")," ",l.a.createElement("span",{className:"token punctuation"},"}"))," ",l.a.createElement("span",{className:"token keyword module"},"from")," ",l.a.createElement("span",{className:"token string"},"'./basic'"),l.a.createElement("span",{className:"token punctuation"},";"))),l.a.createElement("p",null,"你可以添加多个 Demo 文件，在添加 Demo 之后需要在 ",l.a.createElement("code",null,"/src/demo/index.js")," 入口中添加它，这样其才能在 Storybook 中预览。 所有你书写的 Demo 在 ",l.a.createElement("code",null,"npm publish")," 之前的文档生成环节会被提取到文档中，将被用于物料的实时预览。"),l.a.createElement("h2",{id:"demo-依赖"},l.a.createElement("strong",null,"Demo 依赖")),l.a.createElement("p",null,"由于物料平台采取了运行时渲染 Demo 的形式，所以默认情况下你只可以在 Demo 代码中引入以下依赖，它们已经被默认注入到了运行环境中："),l.a.createElement("ul",null,l.a.createElement("li",null,"react"),l.a.createElement("li",null,"react-dom"),l.a.createElement("li",null,"react-router-dom"),l.a.createElement("li",null,"lodash"),l.a.createElement("li",null,"date-fns"),l.a.createElement("li",null,"@bytedesign/web-react"),l.a.createElement("li",null,"@sensoro-design/react"),l.a.createElement("li",null,"物料本身对应的 NPM 包")),l.a.createElement("p",null,"如果必须引入上述之外的依赖才能保证 Demo 的正常运行，我们提供了一种特殊的方式来满足这一需求。按照以下步骤操作："),l.a.createElement("ol",null,l.a.createElement("li",null," 新建 ",l.a.createElement("code",null,"/src/demo/arcoDemoVendor.js")," 文件，将所需要用到的依赖从本文件中导出。")),l.a.createElement("pre",{className:"code_block"},l.a.createElement("code",{className:"language-javascript"},l.a.createElement("span",{className:"token comment"},"// arcoDemoVendor.js"),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword module"},"export")," ",l.a.createElement("span",{className:"token exports"},l.a.createElement("span",{className:"token punctuation"},"{")," myDependency ",l.a.createElement("span",{className:"token punctuation"},"}"))," ",l.a.createElement("span",{className:"token keyword module"},"from")," ",l.a.createElement("span",{className:"token string"},"'@arco-design/somelib'"),l.a.createElement("span",{className:"token punctuation"},";"))),l.a.createElement("ol",{start:"2"},l.a.createElement("li",null," 在 Demo 文件中，从 ",l.a.createElement("code",null,"arcoDemoVendor.js")," 中引入此依赖。")),l.a.createElement("pre",{className:"code_block"},l.a.createElement("code",{className:"language-javascript"},l.a.createElement("span",{className:"token comment"},"// basic.jsx"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword module"},"import")," ",l.a.createElement("span",{className:"token imports"},l.a.createElement("span",{className:"token maybe-class-name"},"Component"))," ",l.a.createElement("span",{className:"token keyword module"},"from")," ",l.a.createElement("span",{className:"token string"},"'@arco-design/my-material'"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword module"},"import")," ",l.a.createElement("span",{className:"token imports"},l.a.createElement("span",{className:"token punctuation"},"{")," myDependency ",l.a.createElement("span",{className:"token punctuation"},"}"))," ",l.a.createElement("span",{className:"token keyword module"},"from")," ",l.a.createElement("span",{className:"token string"},"'./arcoDemoVendor'"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword module"},"export")," ",l.a.createElement("span",{className:"token keyword module"},"default")," ",l.a.createElement("span",{className:"token punctuation"},"("),l.a.createElement("span",{className:"token punctuation"},")")," ",l.a.createElement("span",{className:"token arrow operator"},"=>")," ",l.a.createElement("span",{className:"token punctuation"},"{"),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token keyword control-flow"},"return")," ",l.a.createElement("span",{className:"token tag"},l.a.createElement("span",{className:"token tag"},l.a.createElement("span",{className:"token punctuation"},"<"),l.a.createElement("span",{className:"token class-name"},"Component"))," ",l.a.createElement("span",{className:"token attr-name"},"option"),l.a.createElement("span",{className:"token script language-javascript"},l.a.createElement("span",{className:"token script-punctuation punctuation"},"="),l.a.createElement("span",{className:"token punctuation"},"{"),"myDependency",l.a.createElement("span",{className:"token punctuation"},"}"))," ",l.a.createElement("span",{className:"token punctuation"},"/>")),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("span",{className:"token punctuation"},"}"),l.a.createElement("span",{className:"token punctuation"},";"))),l.a.createElement("ol",{start:"3"},l.a.createElement("li",null," 确保 arco-scripts 版本 >= 1.17.1，并且 Webpack 构建的配置中包含了 arcoDemoVendor 入口。")),l.a.createElement("pre",{className:"code_block"},l.a.createElement("code",{className:"language-javascript"},l.a.createElement("span",{className:"token comment"},"// Lerna Monorepo 模板中的物料构建配置"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword"},"const")," fs ",l.a.createElement("span",{className:"token operator"},"=")," ",l.a.createElement("span",{className:"token function"},"require"),l.a.createElement("span",{className:"token punctuation"},"("),l.a.createElement("span",{className:"token string"},"'fs'"),l.a.createElement("span",{className:"token punctuation"},")"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword"},"const")," path ",l.a.createElement("span",{className:"token operator"},"=")," ",l.a.createElement("span",{className:"token function"},"require"),l.a.createElement("span",{className:"token punctuation"},"("),l.a.createElement("span",{className:"token string"},"'path'"),l.a.createElement("span",{className:"token punctuation"},")"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword"},"const")," merge ",l.a.createElement("span",{className:"token operator"},"=")," ",l.a.createElement("span",{className:"token function"},"require"),l.a.createElement("span",{className:"token punctuation"},"("),l.a.createElement("span",{className:"token string"},"'webpack-merge'"),l.a.createElement("span",{className:"token punctuation"},")"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("span",{className:"token keyword"},"const")," ",l.a.createElement("span",{className:"token punctuation"},"{")," webpack ",l.a.createElement("span",{className:"token punctuation"},"}")," ",l.a.createElement("span",{className:"token operator"},"=")," ",l.a.createElement("span",{className:"token function"},"require"),l.a.createElement("span",{className:"token punctuation"},"("),l.a.createElement("span",{className:"token string"},"'../../../arco.scripts.config'"),l.a.createElement("span",{className:"token punctuation"},")"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("br",null),"module",l.a.createElement("span",{className:"token punctuation"},"."),l.a.createElement("span",{className:"token method-variable function-variable method function property-access"},"exports")," ",l.a.createElement("span",{className:"token operator"},"=")," ",l.a.createElement("span",{className:"token punctuation"},"("),l.a.createElement("span",{className:"token parameter"},"config"),l.a.createElement("span",{className:"token punctuation"},")")," ",l.a.createElement("span",{className:"token arrow operator"},"=>")," ",l.a.createElement("span",{className:"token punctuation"},"{"),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token keyword control-flow"},"if")," ",l.a.createElement("span",{className:"token punctuation"},"("),"webpack",l.a.createElement("span",{className:"token punctuation"},")")," ",l.a.createElement("span",{className:"token punctuation"},"{"),l.a.createElement("br",null),"    ",l.a.createElement("span",{className:"token keyword"},"const")," commonConfig ",l.a.createElement("span",{className:"token operator"},"="),l.a.createElement("br",null),"      ",l.a.createElement("span",{className:"token keyword"},"typeof")," webpack ",l.a.createElement("span",{className:"token operator"},"===")," ",l.a.createElement("span",{className:"token string"},"'function'"),l.a.createElement("br",null),"        ",l.a.createElement("span",{className:"token operator"},"?")," webpack",l.a.createElement("br",null),"        ",l.a.createElement("span",{className:"token operator"},":")," ",l.a.createElement("span",{className:"token keyword"},"typeof")," webpack",l.a.createElement("span",{className:"token punctuation"},"."),l.a.createElement("span",{className:"token property-access"},"component")," ",l.a.createElement("span",{className:"token operator"},"===")," ",l.a.createElement("span",{className:"token string"},"'function'"),l.a.createElement("br",null),"        ",l.a.createElement("span",{className:"token operator"},"?")," webpack",l.a.createElement("span",{className:"token punctuation"},"."),l.a.createElement("span",{className:"token method-variable function-variable method function property-access"},"component"),l.a.createElement("br",null),"        ",l.a.createElement("span",{className:"token operator"},":")," ",l.a.createElement("span",{className:"token punctuation"},"("),l.a.createElement("span",{className:"token punctuation"},")")," ",l.a.createElement("span",{className:"token arrow operator"},"=>")," ",l.a.createElement("span",{className:"token punctuation"},"{"),l.a.createElement("span",{className:"token punctuation"},"}"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),"    config ",l.a.createElement("span",{className:"token operator"},"=")," ",l.a.createElement("span",{className:"token function"},"commonConfig"),l.a.createElement("span",{className:"token punctuation"},"("),"config",l.a.createElement("span",{className:"token punctuation"},")")," ",l.a.createElement("span",{className:"token operator"},"||")," config",l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token punctuation"},"}"),l.a.createElement("br",null),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token keyword"},"const")," entry ",l.a.createElement("span",{className:"token operator"},"=")," ",l.a.createElement("span",{className:"token punctuation"},"{"),l.a.createElement("br",null),"    arco",l.a.createElement("span",{className:"token operator"},":")," path",l.a.createElement("span",{className:"token punctuation"},"."),l.a.createElement("span",{className:"token method function property-access"},"resolve"),l.a.createElement("span",{className:"token punctuation"},"("),"__dirname",l.a.createElement("span",{className:"token punctuation"},",")," ",l.a.createElement("span",{className:"token string"},"'../src/index.tsx'"),l.a.createElement("span",{className:"token punctuation"},")"),l.a.createElement("span",{className:"token punctuation"},","),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token punctuation"},"}"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token keyword"},"const")," demoVendorPath ",l.a.createElement("span",{className:"token operator"},"=")," path",l.a.createElement("span",{className:"token punctuation"},"."),l.a.createElement("span",{className:"token method function property-access"},"resolve"),l.a.createElement("span",{className:"token punctuation"},"("),"__dirname",l.a.createElement("span",{className:"token punctuation"},",")," ",l.a.createElement("span",{className:"token string"},"'../src/demo/arcoDemoVendor.js'"),l.a.createElement("span",{className:"token punctuation"},")"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token keyword control-flow"},"if")," ",l.a.createElement("span",{className:"token punctuation"},"("),"fs",l.a.createElement("span",{className:"token punctuation"},"."),l.a.createElement("span",{className:"token method function property-access"},"existsSync"),l.a.createElement("span",{className:"token punctuation"},"("),"demoVendorPath",l.a.createElement("span",{className:"token punctuation"},")"),l.a.createElement("span",{className:"token punctuation"},")")," ",l.a.createElement("span",{className:"token punctuation"},"{"),l.a.createElement("br",null),"    entry",l.a.createElement("span",{className:"token punctuation"},"."),l.a.createElement("span",{className:"token property-access"},"arcoDemoVendor")," ",l.a.createElement("span",{className:"token operator"},"=")," demoVendorPath",l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token punctuation"},"}"),l.a.createElement("br",null),l.a.createElement("br",null),"  ",l.a.createElement("span",{className:"token keyword control-flow"},"return")," ",l.a.createElement("span",{className:"token function"},"merge"),l.a.createElement("span",{className:"token punctuation"},"("),"config",l.a.createElement("span",{className:"token punctuation"},",")," ",l.a.createElement("span",{className:"token punctuation"},"{")," entry ",l.a.createElement("span",{className:"token punctuation"},"}"),l.a.createElement("span",{className:"token punctuation"},")"),l.a.createElement("span",{className:"token punctuation"},";"),l.a.createElement("br",null),l.a.createElement("span",{className:"token punctuation"},"}"),l.a.createElement("span",{className:"token punctuation"},";"))),l.a.createElement("h2",{id:"开发中预览"},l.a.createElement("strong",null,"开发中预览")),l.a.createElement("p",null,"为了方便开发时快速查看代码修改效果，arco-scripts 提供了以下命令监听代码变动以自动构建："),l.a.createElement("pre",{className:"code_block"},l.a.createElement("code",{className:"language-bash"},l.a.createElement("span",{className:"token comment"},"# 监测组件代码的变动 - tsc & gulp-less"),l.a.createElement("br",null),"arco-scripts dev:component")),l.a.createElement("p",null,"在官方模板项目中，你还需要结合 Storybook 来实时预览调试组件。"))}}}]);