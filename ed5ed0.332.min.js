(window.webpackJsonp=window.webpackJsonp||[]).push([[332],{1135:function(e,a,t){"use strict";t.r(a);var n=t(0),s=t.n(n),l=t(1169);a.default=function(e){const[a,t]=Object(n.useState)(!1),[c,r]=Object(n.useState)(!1);localStorage.getItem("arco-lang");return s.a.createElement("span",{style:e.style,className:"markdown-body"},s.a.createElement(l.a,null,s.a.createElement("title",null,"权限控制 | ArcoDesign"),s.a.createElement("meta",{name:"description",content:"权限控制是中后台场景非常常见的基础功能，在 `v2.1.0` 将权限控制功能集成至 Arco Design Pro"}),s.a.createElement("meta",{property:"og:title",content:"权限控制 | ArcoDesign"}),s.a.createElement("meta",{property:"og:description",content:"权限控制是中后台场景非常常见的基础功能，在 `v2.1.0` 将权限控制功能集成至 Arco Design Pro"})),s.a.createElement("div",{className:"ac-nav-intro"},s.a.createElement("p",null,"Arco Pro"),s.a.createElement("h1",{id:"权限控制"},"权限控制"),s.a.createElement("p",null,"权限控制是中后台场景非常常见的基础功能，在 ",s.a.createElement("code",null,"v2.1.0")," 将权限控制功能集成至 Arco Design Pro")),s.a.createElement("h2",{id:"适用场景"},"适用场景"),s.a.createElement("p",null,"中后台常见的前端权限控制大概可概括为以下场景："),s.a.createElement("ol",null,s.a.createElement("li",null,"菜单权限控制，针对",s.a.createElement("strong",null,"某个菜单/页面"),"进行权限管理，有则能看到此页面，否则将展示无权限。")),s.a.createElement("p",null,s.a.createElement("img",{src:"http://p1-arco.byteimg.com/tos-cn-i-uwbnlip3yd/116622141d7b228ad2259c81cd32d095.gif~tplv-uwbnlip3yd-3.awebp",alt:""})),s.a.createElement("ol",{start:"2"},s.a.createElement("li",null,s.a.createElement("strong",null,"针对某页面中的某触发器"),"进行权限管理，例如对列表页的某一条数据进行删除操作。有权限情况下则展示删除按钮。")),s.a.createElement("p",null,s.a.createElement("img",{src:"http://p1-arco.byteimg.com/tos-cn-i-uwbnlip3yd/7b410fa5dad6e47665c264fae910c0c8.gif~tplv-uwbnlip3yd-3.awebp",alt:""})),s.a.createElement("ol",{start:"3"},s.a.createElement("li",null,s.a.createElement("strong",null,"针对某页面、某对象的某触发器"),"进行权限管理，例如列表页且内容体裁为图文的数据的删除操作。在有权限情况下对这条数据展示删除按钮。")),s.a.createElement("p",null,"Arco Design Pro 在尽力满足以上场景。"),s.a.createElement("h2",{id:"实现"},"实现"),s.a.createElement("p",null,"在实现上，将一个权限权限映射为两个字段，",s.a.createElement("code",null,"resource")," 和 ",s.a.createElement("code",null,"action"),"。"),s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement("code",null,"resource"),": 一个页面，一个触发器，某个元素的某触发器都可以作为 ",s.a.createElement("code",null,"resource"),"。"),s.a.createElement("li",null,s.a.createElement("code",null,"action"),": 用户的具体行为，如：读操作，写操作。")),s.a.createElement("p",null,"所以，用户信息里的权限字段的设计如下："),s.a.createElement("pre",{className:"code_block"},s.a.createElement("code",{className:"language-ts"},s.a.createElement("span",{className:"token doc-comment comment"},"/**",s.a.createElement("br",null)," * ",s.a.createElement("span",{className:"token punctuation"},"{")," data-analysis:  ['read', 'write'] ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null)," */"),s.a.createElement("br",null),s.a.createElement("span",{className:"token keyword"},"export")," ",s.a.createElement("span",{className:"token keyword"},"type")," ",s.a.createElement("span",{className:"token class-name"},"UserPermission")," ",s.a.createElement("span",{className:"token operator"},"=")," Record",s.a.createElement("span",{className:"token operator"},"<"),s.a.createElement("span",{className:"token builtin"},"string"),s.a.createElement("span",{className:"token punctuation"},",")," ",s.a.createElement("span",{className:"token builtin"},"string"),s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),"userInfo",s.a.createElement("span",{className:"token punctuation"},"."),"permission ",s.a.createElement("span",{className:"token operator"},"=")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token string"},"'data-analysis'"),s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token string"},"'read'"),s.a.createElement("span",{className:"token punctuation"},",")," ",s.a.createElement("span",{className:"token string"},"'write'"),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token string"},"'search-table'"),s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token string"},"'read'"),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},";"))),s.a.createElement("p",null,"在权限判断上，Arco Design Pro 不仅支持直接的 ",s.a.createElement("code",null,"resource")," 字符串判断，还支持正则匹配的 ",s.a.createElement("code",null,"resource"),"。以便覆盖更多场景。权限判断具体代码在 ",s.a.createElement("code",null,"@/utils/authentication.ts")," 中，下面做简单讲解。"),s.a.createElement("pre",{className:"code_block"},s.a.createElement("code",{className:"language-ts"},s.a.createElement("span",{className:"token keyword"},"type")," ",s.a.createElement("span",{className:"token class-name"},"Auth")," ",s.a.createElement("span",{className:"token operator"},"=")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"  resource",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token builtin"},"string")," ",s.a.createElement("span",{className:"token operator"},"|")," RegExp",s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  actions",s.a.createElement("span",{className:"token operator"},"?"),s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token builtin"},"string"),s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("span",{className:"token keyword"},"interface")," ",s.a.createElement("span",{className:"token class-name"},"AuthParams")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token comment"},"// 某操作需要的权限数组"),s.a.createElement("br",null),"  requiredPermissions",s.a.createElement("span",{className:"token operator"},"?"),s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token builtin"},"Array"),s.a.createElement("span",{className:"token operator"},"<"),"Auth",s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token comment"},"// 是否需要满足一个即可，即是或还是且。"),s.a.createElement("br",null),"  oneOfPerm",s.a.createElement("span",{className:"token operator"},"?"),s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token builtin"},"boolean"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("span",{className:"token doc-comment comment"},"/**",s.a.createElement("br",null)," * 对 某资源的某操作鉴权",s.a.createElement("br",null)," * actions: 当前资源需要的操作权限",s.a.createElement("br",null)," * perm: 用户对当前资源所拥有的权限",s.a.createElement("br",null)," **/"),s.a.createElement("br",null),s.a.createElement("span",{className:"token keyword"},"const")," ",s.a.createElement("span",{className:"token function-variable function"},"judge")," ",s.a.createElement("span",{className:"token operator"},"=")," ",s.a.createElement("span",{className:"token punctuation"},"("),"actions",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token builtin"},"string"),s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},",")," perm",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token builtin"},"string"),s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token operator"},"=>")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"if")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token operator"},"!"),"perm ",s.a.createElement("span",{className:"token operator"},"||")," ",s.a.createElement("span",{className:"token operator"},"!"),"perm",s.a.createElement("span",{className:"token punctuation"},"."),"length",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token keyword"},"return")," ",s.a.createElement("span",{className:"token boolean"},"false"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token comment"},"// 用户拥有这个资源的全部权限。"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token comment"},"// perm = ['*']"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"if")," ",s.a.createElement("span",{className:"token punctuation"},"("),"perm",s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token function"},"join"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token string"},"''"),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token operator"},"===")," ",s.a.createElement("span",{className:"token string"},"'*'"),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token keyword"},"return")," ",s.a.createElement("span",{className:"token boolean"},"true"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"return")," actions",s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token function"},"every"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},"("),"action",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token operator"},"=>")," perm",s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token function"},"includes"),s.a.createElement("span",{className:"token punctuation"},"("),"action",s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("span",{className:"token doc-comment comment"},"/**",s.a.createElement("br",null)," *  对某资源鉴权",s.a.createElement("br",null)," *  params: resource + actions",s.a.createElement("br",null)," *  userPermission: 用户所拥有的权限",s.a.createElement("br",null)," **/"),s.a.createElement("br",null),s.a.createElement("span",{className:"token keyword"},"const")," ",s.a.createElement("span",{className:"token function-variable function"},"auth")," ",s.a.createElement("span",{className:"token operator"},"=")," ",s.a.createElement("span",{className:"token punctuation"},"("),"params",s.a.createElement("span",{className:"token operator"},":")," Auth",s.a.createElement("span",{className:"token punctuation"},",")," userPermission",s.a.createElement("span",{className:"token operator"},":")," UserPermission",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token operator"},"=>")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"const")," ",s.a.createElement("span",{className:"token punctuation"},"{")," resource",s.a.createElement("span",{className:"token punctuation"},",")," actions ",s.a.createElement("span",{className:"token operator"},"=")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token punctuation"},"]")," ",s.a.createElement("span",{className:"token punctuation"},"}")," ",s.a.createElement("span",{className:"token operator"},"=")," params",s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token comment"},"// 当前 resource 是一个正则"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"if")," ",s.a.createElement("span",{className:"token punctuation"},"("),"resource ",s.a.createElement("span",{className:"token keyword"},"instanceof")," ",s.a.createElement("span",{className:"token class-name"},"RegExp"),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token keyword"},"const")," permKeys ",s.a.createElement("span",{className:"token operator"},"=")," Object",s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token function"},"keys"),s.a.createElement("span",{className:"token punctuation"},"("),"userPermission",s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token comment"},"// 获取用户与之匹配的资源"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token keyword"},"const")," matchPermissions ",s.a.createElement("span",{className:"token operator"},"=")," permKeys",s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token function"},"filter"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},"("),"item",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token operator"},"=>")," item",s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token function"},"match"),s.a.createElement("span",{className:"token punctuation"},"("),"resource",s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token comment"},"// 对匹配的所有资源的权限进行判断。"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token keyword"},"return")," matchPermissions",s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token function"},"every"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},"("),"key",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token operator"},"=>")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token keyword"},"const")," perm ",s.a.createElement("span",{className:"token operator"},"=")," userPermission",s.a.createElement("span",{className:"token punctuation"},"["),"key",s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token keyword"},"return")," ",s.a.createElement("span",{className:"token function"},"judge"),s.a.createElement("span",{className:"token punctuation"},"("),"actions",s.a.createElement("span",{className:"token punctuation"},",")," perm",s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token comment"},"// resource 是一个简单的字符串。"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"const")," perm ",s.a.createElement("span",{className:"token operator"},"=")," userPermission",s.a.createElement("span",{className:"token punctuation"},"["),"resource",s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"return")," ",s.a.createElement("span",{className:"token function"},"judge"),s.a.createElement("span",{className:"token punctuation"},"("),"actions",s.a.createElement("span",{className:"token punctuation"},",")," perm",s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("span",{className:"token doc-comment comment"},"/**",s.a.createElement("br",null)," * 多个资源组合鉴权",s.a.createElement("br",null)," * params: resource + actions 数组",s.a.createElement("br",null)," * userPermission: 用户权限",s.a.createElement("br",null)," **/"),s.a.createElement("br",null),s.a.createElement("span",{className:"token keyword"},"export")," ",s.a.createElement("span",{className:"token keyword"},"default")," ",s.a.createElement("span",{className:"token punctuation"},"("),"params",s.a.createElement("span",{className:"token operator"},":")," AuthParams",s.a.createElement("span",{className:"token punctuation"},",")," userPermission",s.a.createElement("span",{className:"token operator"},":")," UserPermission",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token operator"},"=>")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"const")," ",s.a.createElement("span",{className:"token punctuation"},"{")," requiredPermissions",s.a.createElement("span",{className:"token punctuation"},",")," oneOfPerm ",s.a.createElement("span",{className:"token punctuation"},"}")," ",s.a.createElement("span",{className:"token operator"},"=")," params",s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"if")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token builtin"},"Array"),s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token function"},"isArray"),s.a.createElement("span",{className:"token punctuation"},"("),"requiredPermissions",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token operator"},"&&")," requiredPermissions",s.a.createElement("span",{className:"token punctuation"},"."),"length",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token keyword"},"let")," count ",s.a.createElement("span",{className:"token operator"},"=")," ",s.a.createElement("span",{className:"token number"},"0"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token keyword"},"for")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token keyword"},"const")," rp ",s.a.createElement("span",{className:"token keyword"},"of")," requiredPermissions",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token keyword"},"if")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token function"},"auth"),s.a.createElement("span",{className:"token punctuation"},"("),"rp",s.a.createElement("span",{className:"token punctuation"},",")," userPermission",s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"        count",s.a.createElement("span",{className:"token operator"},"++"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token comment"},"// 或操作 或者 且操作"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token keyword"},"return")," oneOfPerm ",s.a.createElement("span",{className:"token operator"},"?")," count ",s.a.createElement("span",{className:"token operator"},">")," ",s.a.createElement("span",{className:"token number"},"0")," ",s.a.createElement("span",{className:"token operator"},":")," count ",s.a.createElement("span",{className:"token operator"},"===")," requiredPermissions",s.a.createElement("span",{className:"token punctuation"},"."),"length",s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"return")," ",s.a.createElement("span",{className:"token boolean"},"true"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},";"))),s.a.createElement("h2",{id:"使用"},"使用"),s.a.createElement("h3",{id:"菜单权限管理"},"菜单权限管理"),s.a.createElement("p",null,"针对菜单及路由权限控制，可以在 ",s.a.createElement("code",null,"routes.ts")," 中，对某个菜单项增加 ",s.a.createElement("code",null,"requiredPermissions")," 参数即可。"),s.a.createElement("pre",{className:"code_block"},s.a.createElement("code",{className:"language-ts"},s.a.createElement("span",{className:"token keyword"},"const")," routes ",s.a.createElement("span",{className:"token operator"},"=")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"    name",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'menu.visualization'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"    key",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'visualization'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"    children",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"        name",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'menu.visualization.dataAnalysis'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        key",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'visualization/data-analysis'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        requiredPermissions",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("br",null),"          ",s.a.createElement("span",{className:"token punctuation"},"{")," resource",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'menu.visualization.dataAnalysis'"),s.a.createElement("span",{className:"token punctuation"},",")," actions",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token string"},"'read'"),s.a.createElement("span",{className:"token punctuation"},"]")," ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        ",s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"        name",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'menu.visualization.multiDimensionDataAnalysis'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        key",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'visualization/multi-dimension-data-analysis'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        requiredPermissions",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("br",null),"          ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"            resource",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'menu.visualization.dataAnalysis'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"            actions",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token string"},"'read'"),s.a.createElement("span",{className:"token punctuation"},",")," ",s.a.createElement("span",{className:"token string"},"'write'"),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"          ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"          ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"            resource",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'menu.visualization.multiDimensionDataAnalysis'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"            actions",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token string"},"'write'"),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"          ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        ",s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        oneOfPerm",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token boolean"},"true"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},";"))),s.a.createElement("h3",{id:"某按钮权限管理"},"某按钮权限管理"),s.a.createElement("p",null,"Arco Design Pro 封装了 ",s.a.createElement("code",null,"PermissionWrapper")," 组件，可包裹固定元素进行权限管理"),s.a.createElement("pre",{className:"code_block"},s.a.createElement("code",{className:"language-ts"},s.a.createElement("span",{className:"token keyword"},"import")," PermissionWrapper ",s.a.createElement("span",{className:"token keyword"},"from")," ",s.a.createElement("span",{className:"token string"},"'@/components/permissionWrapper'"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("span",{className:"token keyword"},"return")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token operator"},"<"),"PermissionWrapper",s.a.createElement("br",null),"    requiredPermissions",s.a.createElement("span",{className:"token operator"},"="),s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token punctuation"},"{")," resource",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token regex"},s.a.createElement("span",{className:"token regex-delimiter"},"/"),s.a.createElement("span",{className:"token regex-source language-regex"},s.a.createElement("span",{className:"token anchor function"},"^"),"menu",s.a.createElement("span",{className:"token charclass class-name"},"."),"list",s.a.createElement("span",{className:"token charclass class-name"},"."),s.a.createElement("span",{className:"token quantifier number"},"*")),s.a.createElement("span",{className:"token regex-delimiter"},"/")),s.a.createElement("span",{className:"token punctuation"},",")," actions",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token string"},"'write'"),s.a.createElement("span",{className:"token punctuation"},"]")," ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token operator"},"<"),"Button loading",s.a.createElement("span",{className:"token operator"},"="),s.a.createElement("span",{className:"token punctuation"},"{"),"loading",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token operator"},">"),"删除",s.a.createElement("span",{className:"token operator"},"<"),s.a.createElement("span",{className:"token operator"},"/"),"Button",s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token operator"},"<"),s.a.createElement("span",{className:"token operator"},"/"),"PermissionWrapper",s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"))),s.a.createElement("h3",{id:"针对某卡片的某按钮进行权限管理"},"针对某卡片的某按钮进行权限管理"),s.a.createElement("p",null,"这种对特定对象有要求的权限管理，只需要将 ",s.a.createElement("code",null,"resource")," 做的更细致些即可"),s.a.createElement("pre",{className:"code_block"},s.a.createElement("code",{className:"language-ts"},s.a.createElement("span",{className:"token keyword"},"import")," PermissionWrapper ",s.a.createElement("span",{className:"token keyword"},"from")," ",s.a.createElement("span",{className:"token string"},"'@/components/permissionWrapper'"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("span",{className:"token keyword"},"return")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token operator"},"<"),"div",s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token punctuation"},"{"),"data",s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token function"},"map"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},"("),"item",s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token operator"},"=>")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token keyword"},"const")," ",s.a.createElement("span",{className:"token punctuation"},"{")," key",s.a.createElement("span",{className:"token punctuation"},",")," ",s.a.createElement("span",{className:"token operator"},"..."),"rest ",s.a.createElement("span",{className:"token punctuation"},"}")," ",s.a.createElement("span",{className:"token operator"},"=")," item",s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token keyword"},"return")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("br",null),"        ",s.a.createElement("span",{className:"token operator"},"<"),"PermissionWrapper",s.a.createElement("br",null),"          requiredPermissions",s.a.createElement("span",{className:"token operator"},"="),s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("br",null),"            ",s.a.createElement("span",{className:"token punctuation"},"{")," resource",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token template-string"},s.a.createElement("span",{className:"token template-punctuation string"},"`"),s.a.createElement("span",{className:"token string"},"list-card-"),s.a.createElement("span",{className:"token interpolation"},s.a.createElement("span",{className:"token interpolation-punctuation punctuation"},"$","{"),"key",s.a.createElement("span",{className:"token interpolation-punctuation punctuation"},"}")),s.a.createElement("span",{className:"token template-punctuation string"},"`")),s.a.createElement("span",{className:"token punctuation"},",")," actions",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("span",{className:"token string"},"'write'"),s.a.createElement("span",{className:"token punctuation"},"]")," ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"          ",s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),"        ",s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("br",null),"          ",s.a.createElement("span",{className:"token operator"},"<"),"Card ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("span",{className:"token operator"},"..."),"rest",s.a.createElement("span",{className:"token punctuation"},"}")," ",s.a.createElement("span",{className:"token operator"},"/"),s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("br",null),"        ",s.a.createElement("span",{className:"token operator"},"<"),s.a.createElement("span",{className:"token operator"},"/"),"PermissionWrapper",s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token operator"},"<"),s.a.createElement("span",{className:"token operator"},"/"),"div",s.a.createElement("span",{className:"token operator"},">"),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"))),s.a.createElement("p",null,"以上是前端页面进行权限控制的具体使用方法，但是需要结合后端接口将用户所拥有的具体权限返回至前端。"),s.a.createElement("p",null,"同时，在中后台系统中，仅仅有简单的前端权限控制是远远不够的，还需要后端进行接口权限控制。特别是涉及到写操作的一些接口，需要严格把控权限。"))}}}]);