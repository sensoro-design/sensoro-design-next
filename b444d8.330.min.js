(window.webpackJsonp=window.webpackJsonp||[]).push([[330],{1133:function(e,a,t){"use strict";t.r(a);var n=t(0),s=t.n(n),c=t(1169);a.default=function(e){const[a,t]=Object(n.useState)(!1),[l,m]=Object(n.useState)(!1);localStorage.getItem("arco-lang");return s.a.createElement("span",{style:e.style,className:"markdown-body"},s.a.createElement(c.a,null,s.a.createElement("title",null,"模拟数据 | SensoroDesign"),s.a.createElement("meta",{name:"description",content:"拦截 ajax 并返回模拟的数据"}),s.a.createElement("meta",{property:"og:title",content:"模拟数据 | SensoroDesign"}),s.a.createElement("meta",{property:"og:description",content:"拦截 ajax 并返回模拟的数据"})),s.a.createElement("div",{className:"ac-nav-intro"},s.a.createElement("p",null,"Arco Pro"),s.a.createElement("h1",{id:"模拟数据"},"模拟数据"),s.a.createElement("p",null,"拦截 ajax 并返回模拟的数据")),s.a.createElement("h2",{id:"解决方案"},"解决方案"),s.a.createElement("p",null,"前后端并行开发意味着前端需要在没有接口数据的情况下进行开发，在这种情况下如果能提供模拟数据请求的功能，我们的数据请求代码就能正常书写，pro 采用了 Mock.js 来实现这个功能。"),s.a.createElement("p",null,"Mock.js 会拦截 ajax 请求，如果有匹配的 mock 规则，就不会将 ajax 发出去，而是返回 mock 的数据。Mock.js 有着丰富的模拟数据生成方法，建议先读一下文档，文档写的很清晰易懂 ",s.a.createElement("a",{href:"http://mockjs.com/"},"MockJs 文档"),"."),s.a.createElement("pre",{className:"code_block"},s.a.createElement("code",{className:"language-js"},s.a.createElement("span",{className:"token keyword module"},"import")," ",s.a.createElement("span",{className:"token imports"},s.a.createElement("span",{className:"token maybe-class-name"},"Mock"))," ",s.a.createElement("span",{className:"token keyword module"},"from")," ",s.a.createElement("span",{className:"token string"},"'mockjs'"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("span",{className:"token maybe-class-name"},"Mock"),s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token method function property-access"},"mock"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token keyword"},"new")," ",s.a.createElement("span",{className:"token class-name"},"RegExp"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token string"},"'/api/chatList'"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},",")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token arrow operator"},"=>")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"const")," data ",s.a.createElement("span",{className:"token operator"},"=")," ",s.a.createElement("span",{className:"token maybe-class-name"},"Mock"),s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token method function property-access"},"mock"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token string"},"'data|4-6'"),s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"["),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"        ",s.a.createElement("span",{className:"token string"},"'id|+1'"),s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token number"},"1"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        username",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'用户7352772'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        content",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'马上就开始了，好激动！'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        time",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'13:09:12'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"        ",s.a.createElement("span",{className:"token string"},"'isCollect|2'"),s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token boolean"},"true"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token punctuation"},"]"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword control-flow"},"return")," data",s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token property-access"},"data"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"))),s.a.createElement("p",null,"当客户端发送请求的 url 被 ",s.a.createElement("code",null,"new RegExp('/api/chatList')")," 匹配到，Mock.js 就会拦截这条请求，并执行对应的回调函数，返回回调函数中 return 的数据。"),s.a.createElement("blockquote",null,s.a.createElement("p",null,"注意：被 Mock.js 匹配并拦截的请求，不会出现在开发者工具的 network 面板中。")),s.a.createElement("h2",{id:"关闭-mock"},"关闭 Mock"),s.a.createElement("p",null,"为了方便开启和关闭数据模拟功能，每个 ",s.a.createElement("code",null,"Mock")," 都会被 ",s.a.createElement("code",null,"setupMock.setup")," 包裹，setupMock 如下："),s.a.createElement("pre",{className:"code_block"},s.a.createElement("code",{className:"language-js"},s.a.createElement("span",{className:"token keyword module"},"export")," ",s.a.createElement("span",{className:"token keyword module"},"default")," ",s.a.createElement("span",{className:"token keyword"},"function")," ",s.a.createElement("span",{className:"token function"},"setupMock"),s.a.createElement("span",{className:"token punctuation"},"("),"config",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"{")," ",s.a.createElement("br",null),"  mock",s.a.createElement("span",{className:"token operator"},"?"),s.a.createElement("span",{className:"token operator"},":")," boolean",s.a.createElement("span",{className:"token punctuation"},";")," ",s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token function-variable function"},"setup"),s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token arrow operator"},"=>")," ",s.a.createElement("span",{className:"token keyword"},"void")," ",s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword"},"const")," ",s.a.createElement("span",{className:"token punctuation"},"{")," mock ",s.a.createElement("span",{className:"token operator"},"=")," ",s.a.createElement("span",{className:"token operator"},"!"),"__PRODUCTION__",s.a.createElement("span",{className:"token punctuation"},",")," setup ",s.a.createElement("span",{className:"token punctuation"},"}")," ",s.a.createElement("span",{className:"token operator"},"=")," config",s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token keyword control-flow"},"if")," ",s.a.createElement("span",{className:"token punctuation"},"("),"mock ",s.a.createElement("span",{className:"token operator"},"===")," ",s.a.createElement("span",{className:"token boolean"},"false"),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token keyword control-flow"},"return"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token function"},"setup"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},";"))),s.a.createElement("p",null,"非生产环境下默认启动数据模拟，当我们需要调试接口的时候只需要将 setupMock 的 mock 参数置为 false 即可，如下："),s.a.createElement("pre",{className:"code_block"},s.a.createElement("code",{className:"language-js"},s.a.createElement("span",{className:"token keyword module"},"import")," ",s.a.createElement("span",{className:"token imports"},s.a.createElement("span",{className:"token maybe-class-name"},"Mock"))," ",s.a.createElement("span",{className:"token keyword module"},"from")," ",s.a.createElement("span",{className:"token string"},"'mockjs'"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("span",{className:"token keyword module"},"import")," ",s.a.createElement("span",{className:"token imports"},"setupMock")," ",s.a.createElement("span",{className:"token keyword module"},"from")," ",s.a.createElement("span",{className:"token string"},"'../utils/setupMock'"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("span",{className:"token function"},"setupMock"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"  mock",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token boolean"},"false"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token function"},"setup"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token comment"},"// 用户信息"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token maybe-class-name"},"Mock"),s.a.createElement("span",{className:"token punctuation"},"."),s.a.createElement("span",{className:"token method function property-access"},"mock"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token keyword"},"new")," ",s.a.createElement("span",{className:"token class-name"},"RegExp"),s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token string"},"'/api/userInfo'"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},",")," ",s.a.createElement("span",{className:"token punctuation"},"("),s.a.createElement("span",{className:"token punctuation"},")")," ",s.a.createElement("span",{className:"token arrow operator"},"=>")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token keyword control-flow"},"return")," ",s.a.createElement("span",{className:"token punctuation"},"{"),s.a.createElement("br",null),"        name",s.a.createElement("span",{className:"token operator"},":")," ",s.a.createElement("span",{className:"token string"},"'name'"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),"      ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"    ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"),s.a.createElement("br",null),"  ",s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},","),s.a.createElement("br",null),s.a.createElement("span",{className:"token punctuation"},"}"),s.a.createElement("span",{className:"token punctuation"},")"),s.a.createElement("span",{className:"token punctuation"},";"))))}}}]);